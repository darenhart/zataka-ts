(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class y{get images(){return this.#t}get loaded(){return this.#e===this.#s}get loadedCount(){return this.#e}get totalCount(){return this.#s}#t={};#e=0;#s=0;#i;constructor(t){this.#i=t.onComplete,this.#s=Object.keys(t.images).length;for(const[e,s]of Object.entries(t.images))this.#n(e,s)}#n(t,e){const s=new Image;s.src=e,s.onload=()=>{this.#r()},s.onerror=()=>{console.error(`Failed to load image: ${e}`),this.#r()},this.#t[t]=s}#r(){this.#e++,this.#e===this.#s&&this.#i()}}function w(n){return new y(n)}class c{static instance;keyStatus;keyCodes;gameElement=null;keydownHandler;keyupHandler;mousedownHandler;mouseupHandler;initialized=!1;constructor(){this.keyCodes={1:"mouse1",2:"mouse2",32:"space",37:"left",38:"up",39:"right",40:"down",17:"Ctrl",16:"Shift",49:"1",81:"q",77:"m",78:"n",79:"o",80:"p"},this.keyStatus=this.createInitialKeyStatus(),this.keydownHandler=this.handleKeyDown.bind(this),this.keyupHandler=this.handleKeyUp.bind(this),this.mousedownHandler=this.handleMouseDown.bind(this),this.mouseupHandler=this.handleMouseUp.bind(this)}static getInstance(){return c.instance||(c.instance=new c),c.instance}createInitialKeyStatus(){const t={};return Object.values(this.keyCodes).forEach(e=>{t[e]=!1}),t}initialize(t){if(this.initialized){console.warn("KeyboardManager already initialized");return}this.gameElement=t,this.attachEventListeners(),this.gameElement.addEventListener("contextmenu",e=>e.preventDefault()),this.initialized=!0}static resetInstance(){c.instance&&c.instance.destroy(),c.instance=void 0}attachEventListeners(){document.addEventListener("keydown",this.keydownHandler),document.addEventListener("keyup",this.keyupHandler),this.gameElement?(this.gameElement.addEventListener("mousedown",this.mousedownHandler),this.gameElement.addEventListener("mouseup",this.mouseupHandler)):console.error("Game element not found for mouse event listeners")}handleKeyDown(t){const e=this.keyCodes[t.keyCode];e&&(t.preventDefault(),this.keyStatus[e]=!0)}handleKeyUp(t){const e=this.keyCodes[t.keyCode];e&&(t.preventDefault(),this.keyStatus[e]=!1)}handleMouseDown(t){t.button===2?(this.keyStatus.mouse2=!0,t.preventDefault()):t.button===0&&(this.keyStatus.mouse1=!0)}handleMouseUp(t){t.button===2?(this.keyStatus.mouse2=!1,t.preventDefault()):t.button===0&&(this.keyStatus.mouse1=!1)}isKeyPressed(t){return this.keyStatus[t]??!1}reset(){Object.keys(this.keyStatus).forEach(t=>{this.keyStatus[t]=!1})}destroy(){document.removeEventListener("keydown",this.keydownHandler),document.removeEventListener("keyup",this.keyupHandler),this.gameElement&&(this.gameElement.removeEventListener("mousedown",this.mousedownHandler),this.gameElement.removeEventListener("mouseup",this.mouseupHandler)),this.reset(),this.gameElement=null,this.initialized=!1}getKeyStatus(){return this.keyStatus}getPressedKeys(){return Object.entries(this.keyStatus).filter(([,t])=>t).map(([t])=>t)}}const p=c.getInstance();new Proxy({},{get(n,t){return typeof t=="string"?p.isKeyPressed(t):!1},set(){return console.warn("KEY_STATUS is readonly. Use keyboardManager methods instead."),!1}});typeof window<"u"&&window.addEventListener("beforeunload",()=>{p.destroy()});var a=(n=>(n.Splash="splash",n.Select="select",n.Playing="playing",n.End="end",n))(a||{});const S={borderWidth:10,borderColor:"#CCCC55"};class v{#t;#e;constructor(t,e){this.#t=t,this.#e={...S,...e}}draw(t,e,s){this.#t.save(),this.#t.beginPath(),this.#t.rect(0,0,t-s,e),this.#t.lineWidth=this.#e.borderWidth,this.#t.strokeStyle=this.#e.borderColor,this.#t.stroke(),this.#t.restore()}clear(t,e){this.#t.clearRect(0,0,t,e)}}function R(n,t){return new v(n,t)}const E={timeout:100};class x{get active(){return this.#i}#t;#e;#s;#i=!1;#n=0;constructor(t,e,s){this.#t=t,this.#e=e,this.#s={...E,...s}}show(t,e,s){this.#i=!0,this.#n=0;const i=e/2-t.width/2,o=s/2-t.height/2;this.#t.drawImage(t,i,o)}listen(t){this.#i&&(this.#n++,(this.#e.isKeyPressed("mouse1")||this.#e.isKeyPressed("space")||this.#n>this.#s.timeout)&&t())}clear(t,e){this.#i=!1,this.#n=0,this.#t.clearRect(0,0,t,e)}}function z(n,t,e){return new x(n,t,e)}const C={waitTime:100,fontSize:30,fontFamily:"Sans-Serif",fontWeight:"bold"};class b{get active(){return this.#i}#t;#e;#s;#i=!1;#n=0;constructor(t,e,s){this.#t=t,this.#e=e,this.#s={...C,...s}}show(t,e,s,i){this.#i=!0,this.#n=0;const o=s/2-t.width/2,r=i*5/6-t.height;this.#t.drawImage(t,o,r),this.#r(e,s,i)}listen(t){this.#i&&(this.#n++,this.#e.isKeyPressed("space")&&this.#n>this.#s.waitTime&&t())}clear(t,e){this.#i=!1,this.#n=0,this.#t.clearRect(0,0,t,e)}#r(t,e,s){this.#t.save(),this.#t.font=`${this.#s.fontWeight} ${this.#s.fontSize}px ${this.#s.fontFamily}`,this.#t.textAlign="right";const i=6;for(let o=0;o<t.length;o++){const r=t[o];if(!r)continue;const l=e/2,h=s*4/6/i*o+80;this.#t.fillStyle=r.color,this.#t.fillText(r.score.toString(),l,h)}this.#t.restore()}}function k(n,t,e){return new b(n,t,e)}const P=1e3,I={width:150,fontSize:75,fontFamily:"Sans-Serif",fontStyle:"italic",backgroundColor:"#3c3c3c",textAlign:"right"};class F{#t;#e;constructor(t,e){this.#t=t,this.#e={...I,...e}}get width(){return this.#e.width}draw(t,e){this.clear(),this.#s(e),this.#i(t,e)}incrementScores(t,e){for(const s of e)s.name!==t&&!s.dead&&s.score++}clear(){this.#t.clearRect(0,0,this.#e.width,P)}#s(t){this.#t.save(),this.#t.fillStyle=this.#e.backgroundColor,this.#t.fillRect(0,0,this.#e.width,t),this.#t.restore()}#i(t,e){if(t.length===0)return;this.#t.save(),this.#t.font=`${this.#e.fontStyle} ${this.#e.fontSize}px ${this.#e.fontFamily}`,this.#t.textAlign=this.#e.textAlign;const s=t.length;for(let i=0;i<t.length;i++){const o=t[i];if(!o)continue;const r=this.#n(i,s,e);this.#t.fillStyle=o.color,this.#t.fillText(o.score.toString(),r.x,r.y)}this.#t.restore()}#n(t,e,s){const i=this.#e.width*3/4-10,o=s*.9*t/e+80;return{x:i,y:o}}}function A(n,t){return new F(n,t)}const T={updateThrottle:50,offsetX:35,offsetY:10,fontSize:9,fontFamily:"Verdana",color:"#888"};class L{#t;#e;#s=0;#i=performance.now();#n=0;constructor(t,e){this.#t=t,this.#e={...T,...e}}get currentFps(){return this.#s}update(){const t=performance.now();this.#s=this.#r(t),this.#i=t}draw(t,e,s){t&&(this.#n++,this.#n>this.#e.updateThrottle&&(this.#n=0,this.#o(e,s)))}reset(){this.#s=0,this.#i=performance.now(),this.#n=0}#r(t){const e=t-this.#i;if(e<=0)return this.#s;const i=1/(e/1e3);return Math.min(Math.round(i),999)}#o(t,e){const s=t-this.#e.offsetX,i=e-this.#e.offsetY;this.#t.clearRect(s-2,i-10,40,15),this.#t.save(),this.#t.textAlign="left",this.#t.font=`${this.#e.fontSize}px ${this.#e.fontFamily}`,this.#t.fillStyle=this.#e.color,this.#t.fillText(`fps:${this.#s}`,s,i),this.#t.restore()}}function M(n,t){return new L(n,t)}const N={keyLabelXRatio:1/5,iconOffsetX:220,baseY:80,verticalSpacingRatio:.6,fontSize:20,fontFamily:"Courier",fontWeight:"bold",instructionYRatio:7/8,instructionText:"Press space to start",instructionColor:"white"};class B{#t;#e;#s;#i=!1;constructor(t,e,s){this.#t=t,this.#e=e,this.#s={...N,...s}}get active(){return this.#i}show(t,e,s){this.#i=!0,this.#n(t,e,s),this.#r(e,s)}listen(t,e,s,i,o){this.#o(t,e,s,i),this.#d(t,o)}clear(t,e,s){for(const i of t)i.ready=!1;this.#i=!1,this.#t.clearRect(0,0,e,s)}#n(t,e,s){this.#t.save(),this.#t.font=`${this.#s.fontWeight} ${this.#s.fontSize}px ${this.#s.fontFamily}`,this.#t.textAlign="left";for(let i=0;i<t.length;i++){const o=t[i];if(!o)continue;const r=this.#a(i,t.length,e,s);this.#t.fillStyle=o.color,this.#t.fillText(`(${o.left} ${o.right})`,r.x,r.y)}this.#t.restore()}#r(t,e){this.#t.save(),this.#t.fillStyle=this.#s.instructionColor,this.#t.textAlign="center",this.#t.fillText(this.#s.instructionText,t/2,e*this.#s.instructionYRatio),this.#t.restore()}#o(t,e,s,i){for(let o=0;o<t.length;o++){const r=t[o];if(!r)continue;const l=this.#a(o,t.length,s,i),h=e[r.name];if(!h||!this.#c(h))continue;const d=l.x+this.#s.iconOffsetX,u=l.y-h.height;this.#e.isKeyPressed(r.left)?(r.ready=!0,this.#t.drawImage(h,d,u)):this.#e.isKeyPressed(r.right)&&(r.ready=!1,this.#t.clearRect(d,u,h.width,h.height))}}#d(t,e){if(this.#e.isKeyPressed("space")){for(const s of t)if(s.ready){e();break}}}#c(t){return t?t.complete&&t.naturalWidth>0:!1}#a(t,e,s,i){const o=s*this.#s.keyLabelXRatio,r=i*this.#s.verticalSpacingRatio/e*t+this.#s.baseY;return{x:o,y:r}}}function D(n,t,e){return new B(n,t,e)}const H={classic:{maxRounds:15,size:3,speed:1.6,curveSpeed:2,holeRate:450,holeRateRnd:200,holeSize:11,holeSizeRnd:3},agility:{maxRounds:20,size:4,speed:3,curveSpeed:3.5,holeRate:400,holeRateRnd:200,holeSize:9,holeSizeRnd:3},strategy:{maxRounds:5,size:3.2,speed:1,curveSpeed:2,holeRate:220,holeRateRnd:100,holeSize:14,holeSizeRnd:1}};function O(n){return typeof n.maxRounds=="number"&&n.maxRounds>0&&typeof n.size=="number"&&n.size>0&&typeof n.speed=="number"&&n.speed>0&&typeof n.curveSpeed=="number"&&n.curveSpeed>0&&typeof n.holeRate=="number"&&n.holeRate>0&&typeof n.holeRateRnd=="number"&&n.holeRateRnd>=0&&typeof n.holeSize=="number"&&n.holeSize>0&&typeof n.holeSizeRnd=="number"&&n.holeSizeRnd>=0}const $={defaultPreset:"classic",buttonClassicText:"Classic",buttonAdvancedText:"Advanced"};class K{#t;#e;#s=!1;#i=new Map;constructor(t){this.#t={...$,...t}}get active(){return this.#s}initialize(t){this.#e=t,this.setPreset(this.#t.defaultPreset),this.#n()}show(){if(!this.#e)throw new Error("AdvancedSettings not initialized. Call initialize() first.");this.#e.advancedPanel.style.display="block"}hide(){if(!this.#e)throw new Error("AdvancedSettings not initialized. Call initialize() first.");this.#e.advancedPanel.style.display="none"}getConfiguration(){if(!this.#e)throw new Error("AdvancedSettings not initialized. Call initialize() first.");const t=this.#e.inputs,e=parseFloat(t.maxRounds.value),s=parseFloat(t.size.value),i=parseFloat(t.speed.value),o=parseFloat(t.curveSpeed.value),r=parseFloat(t.holeRate.value),l=parseFloat(t.holeRateRnd.value),h=parseFloat(t.holeSize.value),d=parseFloat(t.holeSizeRnd.value);if(isNaN(e))throw new Error("Invalid value for maxRounds");if(isNaN(s))throw new Error("Invalid value for size");if(isNaN(i))throw new Error("Invalid value for speed");if(isNaN(o))throw new Error("Invalid value for curveSpeed");if(isNaN(r))throw new Error("Invalid value for holeRate");if(isNaN(l))throw new Error("Invalid value for holeRateRnd");if(isNaN(h))throw new Error("Invalid value for holeSize");if(isNaN(d))throw new Error("Invalid value for holeSizeRnd");const u={maxRounds:e,size:s,speed:i,curveSpeed:o,holeRate:r,holeRateRnd:l,holeSize:h,holeSizeRnd:d};if(!O(u))throw new Error("Invalid configuration values (out of valid range)");return u}setPreset(t){if(!this.#e)throw new Error("AdvancedSettings not initialized. Call initialize() first.");const e=H[t];this.#c(e)}destroy(){this.#r(),this.#e=void 0}#n(){if(!this.#e)return;const t=this.#o.bind(this);this.#i.set("toggleButton",t),this.#e.advancedButton.addEventListener("click",t);for(const e of this.#e.presetButtons){const s=e.getAttribute("data-preset");if(!s)continue;const i=()=>this.#d(s);this.#i.set(`preset-${s}`,i),e.addEventListener("click",i)}}#r(){if(!this.#e)return;const t=this.#i.get("toggleButton");t&&this.#e.advancedButton.removeEventListener("click",t);for(const e of this.#e.presetButtons){const s=e.getAttribute("data-preset");if(!s)continue;const i=this.#i.get(`preset-${s}`);i&&e.removeEventListener("click",i)}this.#i.clear()}#o(){this.#e&&(this.#s?(this.#s=!1,this.#e.classicButton.click(),this.#e.advancedButton.innerHTML=this.#t.buttonClassicText,this.#e.advancedButton.className="classic",this.#e.form.style.display="none"):(this.#s=!0,this.#e.advancedButton.innerHTML=this.#t.buttonAdvancedText,this.#e.advancedButton.className="",this.#e.form.style.display="block"))}#d(t){this.setPreset(t)}#c(t){if(!this.#e)return;const e=this.#e.inputs;e.maxRounds.value=t.maxRounds.toString(),e.size.value=t.size.toString(),e.speed.value=t.speed.toString(),e.curveSpeed.value=t.curveSpeed.toString(),e.holeRate.value=t.holeRate.toString(),e.holeRateRnd.value=t.holeRateRnd.toString(),e.holeSize.value=t.holeSize.toString(),e.holeSizeRnd.value=t.holeSizeRnd.toString()}}function U(n){return new K(n)}const W={afterDieTime:0,collisionTolerance:30,startTime:40};class q{name;color;#t;#e;score=0;dead=!1;#s;#i;#n;#r;#o;#d;#c;#a;#l;#g;#u;#p;#h;#v;#f=0;#m=0;#y=0;#R=!1;#x=0;#E=0;#w=!1;#S=0;#z=0;#b=0;#C;constructor(t,e,s,i,o){this.name=t.name,this.color=t.color,this.#t=t.left,this.#e=t.right,this.#s=e.size,this.#i=e.speed,this.#n=e.curveSpeed,this.#r=e.holeRate,this.#o=e.holeRateRnd,this.#d=e.holeSize,this.#c=e.holeSizeRnd,this.#a=s.context,this.#l=s.inputManager,this.#g=s.fpsProvider,this.#u=s.dimensions;const r={...W,...i};this.#p=r.afterDieTime,this.#h=r.collisionTolerance,this.#v=r.startTime,this.#C=o}init(){this.#E=0,this.#S=0,this.#x=0,this.#R=!1,this.#w=!1,this.dead=!1;const t=this.#u.width-this.#u.scoreWidth;this.#f=(t-100)*Math.random()+50,this.#m=(this.#u.height-100)*Math.random()+50,this.#y=Math.random()*360,this.#k(),this.#P()}draw(){if(this.#E++,this.#E<this.#v&&this.#E>2)return;if(this.#R&&this.#x>this.#p){this.dead=!0,this.#C&&this.#C(this.name);return}this.#R&&this.#x++;const t=this.#g.currentFps,e=t&&t>20?60/t:1,s=this.#i*e,i=this.#n*e;this.#l.isKeyPressed(this.#t)?this.#y+=i:this.#l.isKeyPressed(this.#e)&&(this.#y-=i);const o=this.#y*Math.PI/180;this.#m+=s*Math.cos(o),this.#f+=s*Math.sin(o),this.#F(),this.#w||(this.#A()&&(this.#R=!0),this.#I())}#k(){this.#z=this.#r+(Math.random()*2-1)*this.#o}#P(){this.#b=this.#d+(Math.random()*2-1)*this.#c}#I(){this.#a.beginPath(),this.#a.fillStyle=this.color,this.#a.arc(this.#f,this.#m,this.#s,0,2*Math.PI),this.#a.fill()}#F(){this.#S++,(this.#S>this.#z||this.#w)&&(this.#w=!0,this.#S>this.#z+this.#b&&(this.#k(),this.#P(),this.#w=!1,this.#S=0))}#A(){const t=this.#u.width-this.#u.scoreWidth;if(this.#f<0||this.#f>t||this.#m<0||this.#m>this.#u.height)return!0;const e=this.#s+2,s=(this.#y+this.#h)*Math.PI/180,i=Math.round(this.#m+e*Math.cos(s)),o=Math.round(this.#f+e*Math.sin(s)),r=this.#a.getImageData(o,i,1,1).data,l=(this.#y-this.#h)*Math.PI/180,h=Math.round(this.#m+e*Math.cos(l)),d=Math.round(this.#f+e*Math.sin(l)),u=this.#a.getImageData(d,h,1,1).data;return r[0]!==0||u[0]!==0}}function G(n,t,e,s,i){return new q(n,t,e,s,i)}const Y=[{ready:!1,count:1,name:"red",color:"#f82801",left:"1",right:"q"},{ready:!1,count:2,name:"yellow",color:"#c0c001",left:"Shift",right:"Ctrl"},{ready:!1,count:3,name:"orange",color:"#f87801",left:"n",right:"m"},{ready:!1,count:4,name:"green",color:"#01c801",left:"left",right:"down"},{ready:!1,count:5,name:"pink",color:"#d850b0",left:"o",right:"p"},{ready:!1,count:6,name:"blue",color:"#02a0c8",left:"mouse1",right:"mouse2"}];class X{get running(){return this.#t}get roundCount(){return this.#e}get maxRounds(){return this.#s}get playerTemplates(){return this.#i}get pool(){return this.#n}#t=!1;#e=0;#s=0;#i;#n=[];#r;#o;#d;#c;#a;#l;constructor(t,e){this.#r=t.context,this.#o=t.playerDependencies,this.#d=t.playerConstants,this.#c=t.onNewRound,this.#a=t.onFinish,this.#l=t.onPlayerDeath,this.#i=e?[...e]:[...Y]}init(t){this.#s=t.maxRounds,this.#e=0,this.#n=[];const e=s=>{this.#l&&this.#l(s),this.checkRoundOver()};for(const s of this.#i)if(s.ready){const i=G(s,t.physics,this.#o,this.#d,e),o=this.#n.find(r=>r.name===s.name);o&&(i.score=o.score),this.#n.push(i)}}startRound(){this.#t=!0,this.#r.clearRect(0,0,this.#o.dimensions.width,this.#o.dimensions.height);for(const t of this.#n)t.init()}animate(){if(this.#t)for(const t of this.#n)t.dead||t.draw();else this.#o.inputManager.isKeyPressed("space")&&(this.#e<this.#s?this.#c&&this.#c():(this.#t=!1,this.#a&&this.#a()))}checkRoundOver(){let t=0;for(const e of this.#n)if(e.dead&&t++,t>=this.#n.length-1){this.#t=!1,this.#e++;break}}}function j(n,t){return new X(n,t)}class _{get state(){return this.#t}get started(){return this.#t===a.Playing}get width(){return this.#e}get height(){return this.#s}#t=a.Splash;#e=0;#s=0;#i;#n;#r;#o;#d;#c;#a;#l;#g;#u;#p;#h;constructor(t){this.#n=t.images,this.#r=t.inputManager,this.#o=t.dependencies}init(){this.#v(),this.#m(),this.#f(),this.showSplashScreen()}onSizeChange(){if(this.#f(),this.#t===a.Playing)this.#d.draw(this.#e,this.#s,this.#l.width),this.#l.draw(this.#h.pool.map(t=>({name:t.name,color:t.color,score:t.score,dead:t.dead})),this.#s);else if(this.#t===a.Splash)this.showSplashScreen();else if(this.#t===a.Select)this.#u.show(Array.from(this.#h.playerTemplates),this.#e,this.#s);else if(this.#t===a.End){const t=this.#h.pool.map(e=>({name:e.name,color:e.color,score:e.score}));this.#a.show(this.#n.end,t,this.#e,this.#s)}}showSplashScreen(){this.#t=a.Splash,this.#o.onShowCursor&&this.#o.onShowCursor(),this.#u.clear(Array.from(this.#h.playerTemplates),this.#e,this.#s),this.#c.show(this.#n.splash,this.#e,this.#s)}showSelectScreen(){this.#t=a.Select,this.#c.clear(this.#e,this.#s),this.#p.show(),this.#u.show(Array.from(this.#h.playerTemplates),this.#e,this.#s),this.#o.githubElement&&(this.#o.githubElement.style.display="block")}start(){this.#t=a.Playing,this.#o.onHideCursor&&this.#o.onHideCursor();const t=this.#p.getConfiguration();this.#h.init({maxRounds:t.maxRounds,physics:{size:t.size,speed:t.speed,curveSpeed:t.curveSpeed,holeRate:t.holeRate,holeRateRnd:t.holeRateRnd,holeSize:t.holeSize,holeSizeRnd:t.holeSizeRnd}}),this.#p.hide(),this.#u.clear(Array.from(this.#h.playerTemplates),this.#e,this.#s),this.#l.draw(this.#h.pool.map(e=>({name:e.name,color:e.color,score:e.score,dead:e.dead})),this.#s),this.newRound(),this.#o.githubElement&&(this.#o.githubElement.style.display="none")}newRound(){this.#h.startRound(),this.#d.draw(this.#e,this.#s,this.#l.width)}finish(){this.#t=a.End,this.#o.onShowCursor&&this.#o.onShowCursor(),this.#d.clear(this.#e,this.#s),this.#l.clear();const t=this.#h.pool.map(e=>({name:e.name,color:e.color,score:e.score}));this.#a.show(this.#n.end,t,this.#e,this.#s)}animate(){this.#g.update(),this.#t===a.Playing?(this.#h.animate(),this.#l.draw(this.#h.pool.map(t=>({name:t.name,color:t.color,score:t.score,dead:t.dead})),this.#s)):this.#t===a.Splash?this.#c.listen(()=>{this.showSelectScreen()}):this.#t===a.Select?this.#u.listen(Array.from(this.#h.playerTemplates),this.#n,this.#e,this.#s,()=>{this.start()}):this.#t===a.End&&this.#a.listen(()=>{this.showSelectScreen()})}#v(){const t=["main","texts","screens","score"];this.#i={};for(const e of t){let s=document.getElementById(e);s||(s=document.createElement("canvas"),s.id=e,this.#o.container.appendChild(s));const i=s.getContext("2d");if(!i)throw new Error(`Failed to get 2D context for canvas: ${e}`);this.#i[e]={element:s,context:i}}}#f(){this.#e=window.innerWidth,this.#s=window.innerHeight;for(const t of Object.values(this.#i))t.element.width=this.#e,t.element.height=this.#s;this.#i.score.element.style.left=`${this.#e-this.#l.width}px`,this.#i.score.element.width=this.#l.width}#m(){this.#g=M(this.#i.texts.context),this.#l=A(this.#i.score.context);const t={get width(){return window.innerWidth},get height(){return window.innerHeight},get scoreWidth(){return 150}},e={context:this.#i.main.context,inputManager:this.#r,fpsProvider:this.#g,dimensions:t};this.#h=j({context:this.#i.main.context,playerDependencies:e,onNewRound:()=>{this.newRound()},onFinish:()=>{this.finish()},onPlayerDeath:h=>{this.#h.running&&this.#l.incrementScores(h,this.#h.pool)}}),this.#d=R(this.#i.main.context),this.#c=z(this.#i.screens.context,this.#r),this.#a=k(this.#i.screens.context,this.#r),this.#u=D(this.#i.screens.context,this.#r),this.#p=U();const s=document.getElementById("advanced"),i=document.getElementById("advanced-button"),o=document.getElementById("advanced-form"),r=document.querySelector('[data-preset="classic"]'),l=Array.from(document.querySelectorAll("[data-preset]"));s&&i&&o&&r&&l.length>0&&this.#p.initialize({advancedPanel:s,advancedButton:i,form:o,classicButton:r,presetButtons:l,inputs:{maxRounds:document.getElementById("maxRounds"),size:document.getElementById("size"),speed:document.getElementById("speed"),curveSpeed:document.getElementById("curveSpeed"),holeRate:document.getElementById("holeRate"),holeRateRnd:document.getElementById("holeRateRnd"),holeSize:document.getElementById("holeSize"),holeSizeRnd:document.getElementById("holeSizeRnd")}})}}function V(n){return new _(n)}let f=null;const J=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)};function g(){J(g),f&&f.animate()}function Q(){f&&f.onSizeChange()}function Z(){document.body.style.cursor="initial"}function tt(){document.body.style.cursor="none"}function et(n){const t=document.getElementById("game");if(!t){console.error("Game container not found");return}const e=document.getElementById("github")||void 0,s=c.getInstance();s.initialize(t),f=V({images:n,inputManager:s,dependencies:{container:t,githubElement:e,onShowCursor:Z,onHideCursor:tt}}),f.init(),g(),window.addEventListener("resize",Q)}function st(){const n=w({images:{splash:"achtung-small.png",end:"achtung-konec-hry.png",red:"red.png",yellow:"yellow.png",orange:"orange.png",green:"green.png",pink:"pink.png",blue:"blue.png"},onComplete:()=>{et(n.images)}})}function m(){st()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();
//# sourceMappingURL=main-CV618CKM.js.map
